<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:AvaloniaUI.Hub"
             xmlns:dgrid="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.DataGrid"
             x:Class="AvaloniaUI.Views.MappingHubView"
             x:CompileBindings="False">

	<DockPanel Margin="12">
		<!-- Top bar -->
		<StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Spacing="8">
			<TextBox Width="220"
					 Watermark="Filtrar ação..."
					 Text="{Binding Filter, UpdateSourceTrigger=PropertyChanged}"/>
			<TextBlock Text="{Binding ConflictSummary}"
					   VerticalAlignment="Center" Opacity="0.8" Margin="8,0,0,0"/>
			<StackPanel Orientation="Horizontal" Spacing="8">
				<Button Content="Recarregar"   Command="{Binding ReloadCommand}"/>
				<Button Content="Limpar tudo"  Command="{Binding ClearAllCommand}"/>
				<Button Content="Salvar"       Command="{Binding SaveCommand}" IsEnabled="{Binding CanSave}"/>
				<Button Content="Cancelar"     Command="{Binding CancelCommand}"/>
			</StackPanel>
		</StackPanel>

		<!-- DataGrid vindo de Avalonia.Controls.DataGrid -->
		<dgrid:DataGrid ItemsSource="{Binding FilteredItems}"
						AutoGenerateColumns="False"
						Margin="0,8,0,0">
			<dgrid:DataGrid.Columns>

				<dgrid:DataGridTextColumn Header="Ação"
										  Binding="{Binding ActionName}"
										  Width="2*"/>

				<dgrid:DataGridTemplateColumn Header="Designação atual" Width="2*">
					<dgrid:DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding AssignedDisplay}"/>
						</DataTemplate>
					</dgrid:DataGridTemplateColumn.CellTemplate>
				</dgrid:DataGridTemplateColumn>

				<dgrid:DataGridTemplateColumn Header="Escolher" Width="2.4*">
					<dgrid:DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<ComboBox ItemsSource="{Binding $parent[UserControl].DataContext.AvailableInputs}"
									  SelectedItem="{Binding Assigned, Mode=TwoWay}"/>
						</DataTemplate>
					</dgrid:DataGridTemplateColumn.CellTemplate>
				</dgrid:DataGridTemplateColumn>

				<dgrid:DataGridTemplateColumn Header="Ações" Width="2*">
					<dgrid:DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal" Spacing="6">
								<Button Content="Detectar" Command="{Binding DetectCommand}"/>
								<Button Content="Limpar"   Command="{Binding ClearCommand}"/>
							</StackPanel>
						</DataTemplate>
					</dgrid:DataGridTemplateColumn.CellTemplate>
				</dgrid:DataGridTemplateColumn>

				<dgrid:DataGridTemplateColumn Header="Conflito" Width="*">
					<dgrid:DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding ConflictNote}" Foreground="Tomato"/>
						</DataTemplate>
					</dgrid:DataGridTemplateColumn.CellTemplate>
				</dgrid:DataGridTemplateColumn>

			</dgrid:DataGrid.Columns>
		</dgrid:DataGrid>

	</DockPanel>
</UserControl>
